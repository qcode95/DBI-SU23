USE master
GO;

IF EXISTS (SELECT name FROM sys.databases
		   WHERE name = 'DBI202_SU23_PROJECT_G4')
	DROP DATABASE DBI202_SU23_PROJECT_G4
GO;

CREATE DATABASE DBI202_SU23_PROJECT_G4
GO;

USE DBI202_SU23_PROJECT_G4
GO;

CREATE TABLE HOTEL
(
	HotID NVARCHAR(5) NOT NULL,
	HotName NVARCHAR(50) NOT NULL,
	HotAddr NVARCHAR(50) NOT NULL,
	Details NVARCHAR(100) NULL,
	CONSTRAINT PK_HOTEL PRIMARY KEY CLUSTERED
	(
		HotID ASC  
	) 
)
GO;

CREATE TABLE EMPLOYEE
(
	EmpSSN DECIMAL(18,0) NOT NULL,
	Fisrt_Name NVARCHAR(20) NOT NULL,
	Last_Name NVARCHAR(50) NOT NULL,
	HotID NVARCHAR(5) NOT NULL,
	RoleID NVARCHAR(5) NOT NULL,
	Sex BIT NULL,
	Date_of_Birth DATETIME NULL,
	Contact DECIMAL(10,0) NULL,
	Salary DECIMAL (10,0) NULL,
	CONSTRAINT PK_EMPLOYEE PRIMARY KEY (EmpSSN),

	CONSTRAINT CK_EMPLOYEE CHECK(YEAR(Date_of_Birth) < YEAR(GETDATE() - 18)),
	CONSTRAINT FK_EMPLOYEE FOREIGN KEY (HotID) REFERENCES HOTEL(HotID),
	CONSTRAINT FK_EMPLOYEE_1 FOREIGN KEY (RoleID) REFERENCES [ROLE](RoleID),
)
GO;

CREATE TABLE [ROLE]
(
	RoleID NVARCHAR(5) NOT NULL,
	RoleTitle NVARCHAR(50) NULL,

	CONSTRAINT PK_ROLE PRIMARY KEY CLUSTERED
	(
		RoleID ASC
	)
)
GO;

CREATE TABLE ROOMS
(
	RoomID NVARCHAR(5) NOT NULL,
	RoomType NVARCHAR(20) NOT NULL,
	HotID NVARCHAR(5) NOT NULL,
	Occupancy NVARCHAR(20) NULL,

	CONSTRAINT PK_ROOMS PRIMARY KEY CLUSTERED 
	(
		RoomID ASC
	),
	CONSTRAINT FK_ROOMS FOREIGN KEY (HotID) REFERENCES HOTEL(HotID),
	CONSTRAINT FK_ROOMS_1 FOREIGN KEY (RoomType) REFERENCES ROOMTYPE(RoomType)
)
GO;

CREATE TABLE ROOMTYPE
(
	RoomType NVARCHAR(20) NOT NULL,
	RoomPrice INT NULL,
	Decription NVARCHAR(100) NULL,

	CONSTRAINT PK_ROOMTYPE PRIMARY KEY (RoomType)
)
GO;

CREATE TABLE BOOKING
(	
	BookingID NVARCHAR(5) NOT NULL,
	RoomID NVARCHAR(5) NOT NULL,
	HotID NVARCHAR(5) NOT NULL,
	BookingDate DATETIME NULL,
	BookingTime DATE NULL,
	ArrivalDate DATETIME NULL,
	ReturnDate DATETIME NULL,
	Number_of_People INT NULL,
	SpecialReq NVARCHAR(100) NULL,

	CONSTRAINT PK_BOOKING PRIMARY KEY CLUSTERED 
	(
		BookingID ASC
	),
	CONSTRAINT FK_BOOKING FOREIGN KEY (HotID) REFERENCES HOTEL(HotID),
	CONSTRAINT FK_BOOKING_1 FOREIGN KEY (RoomID) REFERENCES ROOMS(RoomID), 
)
GO;

CREATE TABLE GUEST
(
	GuestSSN DECIMAL(18,0) NOT NULL,
	HotID NVARCHAR(5) NOT NULL,
	Fisrt_Name NVARCHAR(20) NOT NULL,
	Last_Name NVARCHAR(50) NOT NULL,
	Sex BIT NULL,
	Date_of_Birth DATETIME NULL,
	Contact DECIMAL(10,0) NULL,
	Country NVARCHAR(10),

	CONSTRAINT PK_GUEST PRIMARY KEY (GuestSSN),
)
GO;

CREATE TABLE BILL
(
	BillID NVARCHAR(5) NOT NULL,
	GuestSSN DECIMAL(18,0) NOT NULL,
	RoomCharges INT NULL,
	[Services] NVARCHAR(100) NULL,
	CreditCard DECIMAL(10,0) NULL,
	PaymentMethod NVARCHAR(50) NULL,
	PaymentDate DATETIME NULL,
	ExpiredDate DATETIME NULL,

	CONSTRAINT PK_BILL PRIMARY KEY CLUSTERED
	(
		BillID ASC
	),
	CONSTRAINT FK_BILL FOREIGN KEY (GuestSSN) REFERENCES GUEST(GuestSSN)
)
GO;

INSERT INTO HOTEL VALUES(N'HO001', N'Sea Tower', N'Bình Định', null)
GO;

INSERT INTO EMPLOYEE VALUES('7529810346', N'Nguyễn', N'Văn A', N'HO001', 'RO001', null, null, null, null)
INSERT INTO EMPLOYEE VALUES('6098345271', N'Trần', N'Thị Thùy B', N'HO001', 'RO002', null, null, null, null)
INSERT INTO EMPLOYEE VALUES('2857931460', N'Hoàng', N'Văn C', N'HO001', 'RO003', null, null, null, null)
INSERT INTO EMPLOYEE VALUES('9302164857', N'Nguyễn', N'Gia Hoàng D', N'HO001', 'RO001', null, null, null, null)
INSERT INTO EMPLOYEE VALUES('4165972083', N'Đỗ', N'Thị E', N'HO001', 'RO002', null, null, null, null)
GO;

INSERT INTO [ROLE] VALUES(N'RO001', N'Manager')
INSERT INTO [ROLE] VALUES(N'RO002', N'Receptionist')
INSERT INTO [ROLE] VALUES(N'RO003', N'Security')
GO;

INSERT INTO ROOMS VALUES(N'R0001', N'Normal', N'HO001', null)
INSERT INTO ROOMS VALUES(N'R0002', N'VIP', N'HO001', null)
INSERT INTO ROOMS VALUES(N'R0003', N'President', N'HO001', null)
INSERT INTO ROOMS VALUES(N'R0004', N'Normal', N'HO001', null)
INSERT INTO ROOMS VALUES(N'R0005', N'Normal', N'HO001', null)
INSERT INTO ROOMS VALUES(N'R0006', N'VIP', N'HO001', null)
GO;

INSERT INTO ROOMTYPE VALUES(N'Normal', 500000, null)
INSERT INTO ROOMTYPE VALUES(N'VIP', 1000000, null)
INSERT INTO ROOMTYPE VALUES(N'President', 2000000, null)
GO;

INSERT INTO BOOKING VALUES(N'BO001', N'R0001', N'HO001', null, null, null, null, null, null)
INSERT INTO BOOKING VALUES(N'BO002', N'R0002', N'HO001', null, null, null, null, null, null)
INSERT INTO BOOKING VALUES(N'BO003', N'R0003', N'HO001', null, null, null, null, null, null)
INSERT INTO BOOKING VALUES(N'BO004', N'R0004', N'HO001', null, null, null, null, null, null)
INSERT INTO BOOKING VALUES(N'BO005', N'R0005', N'HO001', null, null, null, null, null, null)
INSERT INTO BOOKING VALUES(N'BO006', N'R0006', N'HO001', null, null, null, null, null, null)
GO;

INSERT INTO GUEST VALUES(N'1256859654', N'HO001', N'Nguyễn', N'Xuân Quý', null, null, null, null)
INSERT INTO GUEST VALUES(N'1256859645', N'HO001', N'Nguyễn Đào', N'Minh Thuận', null, null, null, null)
INSERT INTO GUEST VALUES(N'1256859665', N'HO001', N'Ngô', N'Gia Hoàng', null, null, null, null)
INSERT INTO GUEST VALUES(N'1256859678', N'HO001', N'Huỳnh', N'Lê Trung', null, null, null, null)
INSERT INTO GUEST VALUES(N'1256859689', N'HO001', N'Nguyễn', N'Văn Đại', null, null, null, null)
INSERT INTO GUEST VALUES(N'1256859623', N'HO001', N'Trần', N'Thị Bé', null, null, null, null)
GO;

INSERT INTO BILL VALUES(N'BI001', N'1256859654', null, null, null, null, null, null)
INSERT INTO BILL VALUES(N'BI002', N'1256859645', null, null, null, null, null, null)
INSERT INTO BILL VALUES(N'BI003', N'1256859665', null, null, null, null, null, null)
INSERT INTO BILL VALUES(N'BI004', N'1256859678', null, null, null, null, null, null)
INSERT INTO BILL VALUES(N'BI005', N'1256859689', null, null, null, null, null, null)
INSERT INTO BILL VALUES(N'BI006', N'1256859623', null, null, null, null, null, null)
GO;

